---
title: 变量解构赋值
date: 2025-09-20
tags: ["javascript", "对象", "数组", "解构", "ES6"]
excerpt: "变量的解构赋值"
---

## 变量解构赋值

解构赋值是ES6引入的对赋值运算符的扩展。它是一种针对**数组**或者**对象**进行模式匹配，然后对其中的变量进行赋值。在代码书写上简洁且易读，语义更加清晰明了。也方便了复杂对象中数据字段获取。

在解构中，有下面两部分参与：

+ 解构的源：解构赋值表达式的右边部分。

+ 解构的目标：解构赋值表达式的左边部分。

解构赋值的核心思想是：**模式匹配**。只要等号两边的模式相同，左边的变量就会被赋予对应的值。

### 数组模型的解构

#### 数组解构赋值的基本用法

如果按照传统方式为多个变量赋值

```javascript
let a = 1
let b = 2
let c = 3
```

利用这种方式，分别给变量`a`, `b`, `c`赋值1, 2, 3。

如果使用解构赋值的话，一行就可以完成

```javascript
let [a, b, c] = [1, 2, 3]
```

验证一下

```javascript
console.log("a =", a)
console.log("b =", b)
console.log("c =", c)
```

控制台输出

```console
a = 1
b = 2
c = 3
```

上面的代码表示，可以从数组中提取值，按照对应的位置为变量赋值。

#### 嵌套解构

解构可以用于嵌套数组。

```javascript
let [a, [[b], c]] = [1, [[2], 3]]
```

此时

```console
a = 1
b = 2
c = 3
```

#### 忽略某些元素

可以通过留空来忽略某些不关心的元素。

```javascript
let [a, , b] = [1, 2, 3]
```

此时

```console
a = 1
b = 3
```

#### 解构失败与默认值

当解构模式有匹配结果，且匹配结果是`undefined`时，会触发默认值作为返回结果。

```javascript
let [a = 2] = [undefined]
```

在解构匹配的时候，由于右边对应位置的值为`undefined`，且左边`a`有默认值2，所以

```console
a = 2
```

如果右边匹配的值为`null`，则不会触发默认值。

如果解构失败，则变量的值也为`undefined`。

```javascript
let [a, b] = [1]
```

对于变量`a`可以在右边找打对应位置的值1，对于变量b则找不到对应的值，此时

```console
a = 1
b = undefined
```

综合一下

```javascript
let [a = 3, b = a] = []
let [a = 3, b = a] = [1]
let [a = 3, b = a] = [1, 2]
```

+ `a`与`b`匹配结果为`undefined`，触发默认值

```console
a = 3  b = a = 3
```

+ 变量`a`正常解构赋值，匹配结果`a = 1`，变量`b`匹配结果`undefined`，触发默认值`b = a = 1`

+ `a`与`b`正常解构赋值，匹配结果

```console
a = 1  
b = 2
```

#### 不完全解构

等号左边的模式只匹配等号右边数组的一部分。

```javascript
let [a, b] = [1, 2, 3]
```

此时

```console
a = 1
b = 2
```

如果匹配数组中包括嵌套数组

```javascript
let [a, [b], d] = [1, [2, 3], 4]
```

此时

```console
a = 1
b = 2
d = 4
```

#### 剩余运算符

可以使用Rest参数（`...`）来捕获剩余的所有项，但它必须是解构模式的最后一个元素。

```javascript
let [a, ...b] = [1, 2, 3]
```

此时

```console
a = 1
b = [2, 3]
```

#### 字符串

在数组的解构中，解构的目标若为可遍历对象，皆可进行解构赋值。可遍历对象即实现Iterator接口的数据。

```javascript
let [a, b, c, d, e] = 'hello'
```

此时

```console
a = 'h'
b = 'e'
c = 'l'
d = 'l'
e = 'o'
```

### 对象模型的解构

对象的解构与数组类似，但最关键的区别是：数组的元素是按次序排列的，而对象的属性没有次序，变量必须与属性**同名**才能取到正确的值。

#### 对象解构赋值的基本用法

```javascript
let { foo, bar } = { foo: 'aaa', bar: 'bbb' }
```

此时

```console
foo = 'aaa'
bar = 'bbb'
```

上面的代码中，变量`foo`和`bar`必须与对象中的属性名一致。

如果变量名和属性名不一致，必须写成下面这样。

```javascript
let { baz : foo } = { baz : 'ddd' }
```

此时

```console
foo = 'ddd'
```

这实际上说明，对象的解构赋值是以下形式的简写：

```javascript
let { foo: foo, bar: bar } = { foo: 'aaa', bar: 'bbb' }
```

也就是说，对象的解构赋值的内部机制，是先找到同名属性，然后再赋给对应的变量。**真正被赋值的是后者（冒号后面的变量），而不是前者（冒号前面的模式）**。

对于下面的对象

```javascript
let user = {
    name: "Bob",
    age: "20"
}
```

使用传统的方式读取

```javascript
console.log(user.name)
console.log(user.age)
```

使用解构的方式读取可以

```javascript
const { name, age } = user
```

这段代码等同于

```javascript
const name = user.name
const age = user.age
```

上述代码的解构模式是先从`user`对象中查找`name`和`age`属性，然后将找到的属性分别赋值给同名的`name`和`age`变量。此时就可以通过`name`和`age`变量直接访问`user`的`name`和`age`属性。

>**注意**
>
>+ 对于对象的解构赋值，属性名必须匹配，对象的解构基于属性名，变量名必须与对象中的属性名一致。
>+ 由于按照属性名匹配，所以变量的顺序是不影响结果的。
>+ ES6提供的语法糖，让代码更容易编写和阅读，但并不会增加语言的功能。

#### 嵌套解构

```javascript
let obj = {
  p: [
    'Hello',
    { y: 'World' }
  ]
}

// 解构赋值
let { p: [x, { y }] } = obj
```

在控制台输出

```javascript
console.log(x)
console.log(y)
console.log(p)
```

输出结果

```console
Hello
World
Uncaught ReferenceError ReferenceError: p is not defined
```

如果也要将p作为变量赋值，可以写成：

```javascript
let { p, p: [x, { y }] } = obj
```

此时`p`的值为

```console
['Hello', {y: 'World'}]
```

#### 不完全解构

等号左边的模式只匹配等号右边对象的一部分。

```javascript
let user = {
    name: "Bob",
    age: "20"
}

const { name } = user
```

控制台打印`user`的两个属性。

```javascript
console.log("name =", name)
console.log(age)
```

控制台输出

```console
name = Bob
Uncaught ReferenceError ReferenceError: age is not defined
```

#### 剩余运算符

```javascript
let {a, b, ...rest} = {a: 10, b: 20, c: 30, d: 40}
```

此时各个变量的分别为

```console
a = 10
b = 20
rest = {c: 30, d: 40}
```

#### 解构默认值

```javascript
let {a = 10, b = 5} = {a: 3}
```

对于属性`a`解构化赋值为3，对于属性`b`右边没有赋值，使用默认值5。

```console
a = 3 b = 5
```

#### 重命名解构赋值

对象解构重命名的基本语法是

```javascript
let { 原属性名: 新变量名 } = 对象
```

如果带上默认值

```javascript
let {a: aa = 10, b: bb = 5} = {a: 3}
```

上述代码格式为

```javascript
let { 原属性名: 新变量名 = 默认值 } = 对象
```

此时各个变量的值分别为

```console
aa = 3 bb = 5
```
